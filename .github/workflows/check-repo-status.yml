name: ğŸ” Check Repo Status

on:
  workflow_dispatch:

permissions:
  contents: read

jobs:
  check-status:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      
      - name: ğŸ” DiagnÃ³stico Completo
        run: |
          echo "="*70
          echo "  ğŸ” DIAGNÃ“STICO DEL REPOSITORIO"
          echo "="*70
          echo ""
          
          echo "ğŸ“Š ESTADO DE GIT:"
          echo "â”€"*70
          git status
          echo ""
          
          echo "ğŸ“œ ÃšLTIMOS 5 COMMITS:"
          echo "â”€"*70
          git log --oneline -5
          echo ""
          
          echo "ğŸŒ¿ BRANCHES:"
          echo "â”€"*70
          git branch -a
          echo ""
          
          echo "ğŸ“‚ ARCHIVOS CRÃTICOS:"
          echo "â”€"*70
          
          if [ -d "ADAUSD_MODELS" ]; then
            echo "âœ… ADAUSD_MODELS/ existe"
            ls -lh ADAUSD_MODELS/ | head -10
          else
            echo "âŒ ADAUSD_MODELS/ NO existe"
          fi
          
          echo ""
          
          if [ -f "ADAUSD_1h_data.csv" ]; then
            echo "âœ… ADAUSD_1h_data.csv existe ($(wc -l < ADAUSD_1h_data.csv) lÃ­neas)"
          else
            echo "âŒ ADAUSD_1h_data.csv NO existe"
          fi
          
          echo ""
          
          if [ -f "adausd_results.png" ]; then
            echo "âœ… adausd_results.png existe ($(du -h adausd_results.png | cut -f1))"
          else
            echo "âš ï¸ adausd_results.png NO existe"
          fi
          
          echo ""
          echo "ğŸ”„ DIFERENCIAS CON REMOTO:"
          echo "â”€"*70
          
          LOCAL=$(git rev-parse HEAD)
          REMOTE=$(git rev-parse origin/main)
          
          if [ "$LOCAL" == "$REMOTE" ]; then
            echo "âœ… Local y remoto sincronizados"
          else
            echo "âš ï¸ Local y remoto DIVERGEN"
            echo "   Local:  $LOCAL"
            echo "   Remote: $REMOTE"
            echo ""
            echo "Diferencias:"
            git log --oneline HEAD..origin/main
          fi
          
          echo ""
          echo "ğŸ“‹ ARCHIVOS MODIFICADOS (si hay):"
          echo "â”€"*70
          
          if git diff --name-only | grep -q .; then
            echo "âš ï¸ Archivos modificados:"
            git diff --name-only
          else
            echo "âœ… No hay archivos modificados"
          fi
          
          echo ""
          echo "ğŸ“¦ ARCHIVOS SIN RASTREAR (si hay):"
          echo "â”€"*70
          
          if git ls-files --others --exclude-standard | grep -q .; then
            echo "âš ï¸ Archivos sin rastrear:"
            git ls-files --others --exclude-standard
          else
            echo "âœ… No hay archivos sin rastrear"
          fi
          
          echo ""
          echo "="*70
          echo "  âœ… DIAGNÃ“STICO COMPLETADO"
          echo "="*70
